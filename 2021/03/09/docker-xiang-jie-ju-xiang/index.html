<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Docker详解(巨详), 天听">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Docker详解(巨详) | 天听</title>
    <link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="/medias/avatar.ico">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"><link rel="alternate" href="/atom.xml" title="天听" type="application/atom+xml">
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/avatar.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">天听</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>主页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>类别</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>档案</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>联系人</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>朋友</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>媒体</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/musics">
          
          <i class="fas fa-music" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>音乐</span>
        </a>
      </li>
      
      <li>
        <a href="/movies">
          
          <i class="fas fa-film" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>影视</span>
        </a>
      </li>
      
      <li>
        <a href="/books">
          
          <i class="fas fa-book" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>书籍</span>
        </a>
      </li>
      
      <li>
        <a href="/galleries">
          
          <i class="fas fa-image" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>画廊</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/avatar.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">天听</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			主页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			类别
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			档案
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			联系人
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			朋友
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			媒体
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/musics " style="margin-left:75px">
				  
				   <i class="fa fas fa-music" style="position: absolute;left:50px" ></i>
			      
		          <span>音乐</span>
                  </a>
                </li>
              
                <li>

                  <a href="/movies " style="margin-left:75px">
				  
				   <i class="fa fas fa-film" style="position: absolute;left:50px" ></i>
			      
		          <span>影视</span>
                  </a>
                </li>
              
                <li>

                  <a href="/books " style="margin-left:75px">
				  
				   <i class="fa fas fa-book" style="position: absolute;left:50px" ></i>
			      
		          <span>书籍</span>
                  </a>
                </li>
              
                <li>

                  <a href="/galleries " style="margin-left:75px">
				  
				   <i class="fa fas fa-image" style="position: absolute;left:50px" ></i>
			      
		          <span>画廊</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://god_hearing.gitee.io/" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>god-hearing
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://god_hearing.gitee.io/" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="god-hearing" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/78.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Docker详解(巨详)</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Docker/">
                                <span class="chip bg-color">Docker</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Docker/" class="post-category">
                                Docker
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2021-03-09
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>Update Date:&nbsp;&nbsp;
                    2021-03-09
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>Word Count:&nbsp;&nbsp;
                    6.1k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>Read Times:&nbsp;&nbsp;
                    25 Min
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>Read Count:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><h2 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h2><h3 id="镜像"><a href="#镜像" class="headerlink" title="镜像"></a>镜像</h3><blockquote>
<p>  类似于虚拟机镜像、或者是面对对象里的”类”。如果一个镜像可以包含一个基本的操作系统环境，里面仅安装Apache，就可以把它称为Apache镜像，镜像是创建 docker 容器的基础。</p>
<p>  <strong>注意：镜像自身是只读的，容器从镜像启动的时候，会在镜像的最上层创建一个可写层。</strong></p>
</blockquote>
<h3 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h3><blockquote>
<p>  类似于一个轻量级的沙箱，或者是面对对象里的 “对象”。 docker  利用容器来运行和隔离应用，容器是从镜像创建的应用运行实例，可以将其启动、开始、停止、删除，而且这些容器都是彼此相互隔离的，互不可见的。</p>
<p>  可以把容器看作是一个简易版的Linux系统环境，以及运行在其中的应用程序打包而成的盒子。</p>
</blockquote>
<h3 id="仓库"><a href="#仓库" class="headerlink" title="仓库"></a>仓库</h3><blockquote>
<p>  类似于代码仓库，它是  docker 集中存放镜像文件的场所，一个仓库集中存放某一类镜像，往往包括多个镜像文件，通过不同的标签（tag）来进行区分。</p>
<p>  例如：存放 ubuntu 镜像的仓库称为 ubuntu 仓库，其中可能包含14.04、12.04等不同版本的镜像。</p>
<p>   docker  仓库分为公开仓库和私有仓库，比较出名的公开仓库有： docker  Hub、时速云、aliyun 等。 </p>
</blockquote>
<h2 id="安装及配置"><a href="#安装及配置" class="headerlink" title="安装及配置"></a>安装及配置</h2><blockquote>
<ol>
<li> 卸载旧版本 ：yum remove  docker * ；</li>
<li> 安装  docker ：yum -y install  docker ，如果提示您接受 GPG 密钥，请选“是” ；</li>
<li> [可选] 配置用户组： docker  安装后自动创建 docker 用户组，我们可以将用户添加到 docker 用户组，可以避免每次都使用 sudo 运行：usermod -aG docker YOUR_NAME ；</li>
<li> [可选] 让 docker 服务可以通过本地 2375 端口接受来自外部的请求：docker _OPTS=”$ docker _OPTS -H tcp://0.0.0.0:2375 -H unix:/// /var/run/ docker .sock” ；</li>
<li> [可选] 然后重启 docker 服务：systemctl restart  docker ；</li>
<li> 启动 docker ：systemctl start  docker ；</li>
<li> 运行 hello-world 镜像来验证是否正确安装 ：docker  run hello-world ；</li>
</ol>
</blockquote>
<h2 id="基础命令"><a href="#基础命令" class="headerlink" title="基础命令"></a>基础命令</h2><blockquote>
<ul>
<li><p>  info：显示 docker 系统信息，包括镜像和容器数；</p>
</li>
<li><p>  version：显示 docker 版本信息；</p>
</li>
</ul>
</blockquote>
<h2 id="仓库管理命令"><a href="#仓库管理命令" class="headerlink" title="仓库管理命令"></a>仓库管理命令</h2><blockquote>
<ul>
<li><p>login ：登陆到一个 docker 镜像仓库，未指定镜像仓库地址，默认为官方仓库 docker Hub ；</p>
<pre class=" language-shell"><code class="language-shell">docker login [Options] [SERVER]
[Options]:
    -u: 登陆的用户名
    -p: 登陆的密码</code></pre>
</li>
<li><p>logout ：登出镜像仓库，未指定镜像仓库地址，默认为官方仓库 docker Hub ；</p>
<pre class=" language-shell"><code class="language-shell">docker logout [SERVER]</code></pre>
</li>
<li><p>pull ：从镜像仓库中拉取或者更新指定镜像 ；</p>
<pre class=" language-shell"><code class="language-shell">docker pull [Options] NAME[:TAG]
[Options]:
    -a: 拉取所有 tagged 镜像
    --disable-content-trust: 忽略镜像的校验,默认开启</code></pre>
</li>
<li><p>push ：将本地的镜像上传到镜像仓库 ；</p>
<pre class=" language-shell"><code class="language-shell">docker push [Options] NAME[:TAG]
[Options]:
    --disable-content-trust: 忽略镜像的校验,默认开启</code></pre>
</li>
<li><p>search ：从 docker  Hub 查找镜像 ；</p>
<pre class=" language-shell"><code class="language-shell">docker search [Options] Name
[Options]:
    --automated: 只列出 automated build 类型的镜像
    --no-trunc: 显示完整的镜像描述
    -s: 列出收藏数不小于指定值的镜像
    -f：过滤条件？</code></pre>
</li>
</ul>
</blockquote>
<h2 id="镜像管理命令"><a href="#镜像管理命令" class="headerlink" title="镜像管理命令"></a>镜像管理命令</h2><blockquote>
<ul>
<li><p>images：列出所有本地镜像 ；</p>
<pre class=" language-shell"><code class="language-shell">docker images [Options] [REPOSITORY[:TAG]]
[Options]:
    -a: 列出本地所有的镜像（含中间映像层，默认情况下，过滤掉中间映像层）
    --digests: 显示镜像的摘要信息
    -f: 显示满足条件的镜像
    --format: 指定返回值的模板文件
     --no-trunc: 显示完整的镜像信息
     -q: 只显示镜像ID</code></pre>
</li>
<li><p>rmi : 删除本地一个或多少镜像 ；</p>
<pre class=" language-shell"><code class="language-shell">docker rmi [OPTIONS] IMAGE [IMAGE...]
    -f: 强制删除
    --no-prune: 不移除该镜像的过程镜像，默认移除</code></pre>
</li>
<li><p>tag : 为镜像添加一个标签 ；</p>
<pre class=" language-shell"><code class="language-shell">docker tag  IMAGE[:TAG] [REGISTRYHOST/][USERNAME/]NAME[:TAG]</code></pre>
</li>
<li><p>history：查看指定镜像的创建历史 ；</p>
<pre class=" language-shell"><code class="language-shell">docker history [Options] IMAGE
[Options]:
    -H: 以可读的格式打印镜像大小和日期，默认为true
    --no-trunc: 显示完整的提交记录
    -q: 仅列出提交记录ID</code></pre>
</li>
<li><p>save：将指定镜像保存成 tar 归档文件 ；</p>
<pre class=" language-shell"><code class="language-shell">docker save [Options] IMAGE [IMAGE...]
[Options]:
    -o: 输出到的文件
# 示例：
$ docker save centos_test_v3.tar centos:v3</code></pre>
</li>
<li><p>load：导入使用 save 命令导出的镜像 ；</p>
<pre class=" language-shell"><code class="language-shell">docker load [Options]
[Options]:
    --input,-i :指定导入的文件，代替 STDIN
    --quiet,-q :精简输出信息

# 示例1：
$ docker load < busybox.tar.gz
# Loaded image: busybox:latest

# 示例2:
$ docker load --input fedora.tar
# Loaded image: fedora:latest</code></pre>
</li>
<li><p>import：导入镜像 ；</p>
<pre class=" language-shell"><code class="language-shell">docker  import [Options] file|URL(压缩文件或url) [容器名:标签]
[Options]:
    -c: 应用 docker 指令创建镜像
    -m: 提交时的说明文字

# 示例：
$ docker import centos_test.tar os/centos_test:v2</code></pre>
</li>
</ul>
</blockquote>
<h2 id="容器管理命令"><a href="#容器管理命令" class="headerlink" title="容器管理命令"></a>容器管理命令</h2><h3 id="生命周期管理"><a href="#生命周期管理" class="headerlink" title="生命周期管理"></a>生命周期管理</h3><blockquote>
<ul>
<li><p>run：根据镜像创建并启动一个容器 ；</p>
<pre class=" language-shell"><code class="language-shell">docker run [Options] image-name
[Options]:
    -i: 以交互模式运行容器，通常与 -t 同时使用
    -t: 为容器重新分配一个伪输入终端，通常与 -i 同时使用
    -a: 指定标准输入输出内容类型，可选 STDIN/STDOUT/STDERR 三项
    -d: 后台运行容器，并返回容器ID
    -p: 指定端口映射，格式为：8000:8000
    -m: 设置容器使用内存最大值
    -P: 随机端口映射，容器内部端口随机映射到主机的高端口
    -e username="ritchie": 设置容器的环境变量
    -h "mars": 指定容器的 hostname
    --restart='always': 设置容器自动重启，[no:不重启/on-failure:非0退出时重启]
    --name="nginx-lb":为容器指定一个名称
    --network='bridge'：指定容器的网络
    --privileged=True：让容器获取宿主机 root 权限
    --link=[]: 添加链接到另一个容器
    --volume,-v: 绑定一个卷
    --dns 8.8.8.8: 指定容器使用的DNS服务器，默认和宿主一致
    --dns-search example.com: 指定容器DNS搜索域名，默认和宿主一致
    --env-file=[]: 从指定文件读入环境变量
    --cpuset="0,1,2": 绑定容器到指定CPU运行
    --net="bridge": 指定容器的网络连接类型，支持 bridge/host/none/container
    --expose=[]: 开放一个端口或一组端口
    --rm：退出容器时删除容器</code></pre>
</li>
<li><p>create：创建一个新的容器但不启动它 ；</p>
<pre class=" language-shell"><code class="language-shell"> docker create [Options] IMAGE [COMMAND] [ARG...]
 [Options]: 命令同 run</code></pre>
</li>
<li><p>start/stop/restart：启动/停止/重启 一个或多个容器 ；</p>
<pre class=" language-shell"><code class="language-shell">docker stop id/name[容器2, ...]
docker start id/name[容器2, ...]
docker restart id/name[容器2, ...]</code></pre>
</li>
<li><p>pause/unpause ：暂停/恢复 一个或多个容器进程 ；</p>
<pre class=" language-SHELL"><code class="language-SHELL">docker pause id/name[容器2, ...]
docker unpause id/name[容器2, ...]</code></pre>
</li>
<li><p>kill：杀掉一个运行中的容器 ；</p>
<pre class=" language-shell"><code class="language-shell">docker kill [Options] id/name
[Options]:
    -s :向容器发送一个信号

# 示例：
$ docker kill -s KILL mynginx</code></pre>
</li>
<li><p>rm：删除容器 ；</p>
<pre class=" language-shell"><code class="language-shell">docker rm [Options] id/name[容器2, ...]
[Options]:
     -f: 强制删除一个运行中的容器
    -l: 移除容器间的网络连接，而非容器本身
     -v: 删除与容器关联的卷

# 示例1：删除所有未运行的容器
$ docker rm $(docker ps -aq)
# 示例2：删除所有终止状态的容器
$ docker container prune</code></pre>
</li>
</ul>
</blockquote>
<h3 id="容器操作"><a href="#容器操作" class="headerlink" title="容器操作"></a>容器操作</h3><blockquote>
<ul>
<li><p>ps：查看容器 ；</p>
<pre class=" language-shell"><code class="language-shell">docker ps [Options]
[Options]:
    -a: 显示所有的容器，包括未运行的
    -q: 只显示容器编号
    -l: 显示最近创建的容器
    -n: 列出最近创建的n个容器
    -s: 显示总的文件大小
    -f: 根据条件过滤显示的内容
    --format : 指定返回值的模板文件
    --no-trunc: 不截断输出</code></pre>
</li>
<li><p>exec：进入容器或在运行的容器中执行命令 ；</p>
<pre class=" language-shell"><code class="language-shell">docker exec [Options] id/name COMMAND [ARG...]
[Options]:
    -d: 后台运行
    -i: 即使没有附加也保持 STDIN 打开
    -t: 分配一个伪终端

COMMAND：要在容器中执行的命令
[ARG...]: 命令的参数

# 示例：
$ docker exec -it c3c7732da20e /bin/bash</code></pre>
</li>
<li><p>top：查看容器中运行的进程信息 ；</p>
<pre class=" language-shell"><code class="language-shell">docker top id</code></pre>
</li>
<li><p>logs：查看容器日志 ；</p>
<pre class=" language-shell"><code class="language-shell">docker logs [Options] id/name
[Options]:
    -t: 显示时间戳
    -f: 跟踪日志输出
    --tail: 仅列出最新N条容器日志
    --since: 显示某个开始时间的所有日志</code></pre>
</li>
<li><p>inspect： 获取容器/镜像的元数据（配置信息）。</p>
<pre class=" language-shell"><code class="language-shell">docker inspect [Options] id/name
[Options]:
    -s: 显示总的文件大小
    -f: 指定返回值的模板文件
    --type: 指定返回类型 JSON</code></pre>
</li>
<li><p>attach：进入容器 ；</p>
<pre class=" language-shell"><code class="language-shell">docker attach [Options] id/name
[Options]:
    --sig-proxy=false: 退出容器时不停止容器

注意：使用 attach 进入容器，ctrl + c/d 退出容器时会停止容器，所以需要使用 --sig-proxy=false 参数</code></pre>
</li>
<li><p>events: 从服务器获取实时事件 ；</p>
<pre class=" language-shell"><code class="language-shell">docker events [Options]
[Options]:
    -f：根据条件过滤事件
    --since：从指定的时间戳后显示所有事件
    --until：流水时间显示到指定的时间为止</code></pre>
</li>
<li><p>wait: 阻塞运行直到容器停止，然后打印出它的退出代码 ；</p>
<pre class=" language-shell"><code class="language-shell">docker wait id/name</code></pre>
</li>
<li><p>export：导出容器 ；</p>
<pre class=" language-shell"><code class="language-shell">docker export [Options] id/name
[Options]:
    -o: 将输入内容写到文件

# 示例1：将 id 为 abcdefg 的容器按日期保存为tar文件
$ docker export -o centos-'date +%Y%m%d'.tar abcdefg 
# 示例2：将容器 test_centos 导出为 centos_test.tar
$ docker export test_centos > ./centos_test.tar</code></pre>
</li>
<li><p>port：列出指定的容器的端口映射</p>
<pre class=" language-shell"><code class="language-shell">docker port id/name</code></pre>
</li>
<li><p>  rename：重命名一个容器 ；</p>
</li>
<li><p>  update：更新一个或多个容器的配置 ；</p>
</li>
</ul>
</blockquote>
<h3 id="容器rootfs"><a href="#容器rootfs" class="headerlink" title="容器rootfs"></a>容器rootfs</h3><blockquote>
<ul>
<li><p>commit：根据容器创建一个新的镜像 ；</p>
<pre class=" language-shell"><code class="language-shell">docker commit [Options] id/name 镜像名:标签
[Options]:
    -a: 提交的镜像作者
    -c: 使用 docker file指令来创建镜像
    -m: 提交时的说明文字
    -p: 在commit时，将容器暂停</code></pre>
</li>
<li><p>cp：用于容器与主机之间的数据拷贝 ；</p>
<pre class=" language-shell"><code class="language-shell"># 将容器内数据拷贝到外部
docker cp [Options] id/name:from_path to_host_path
# 将外部数据拷贝到容器内
docker cp [Options] from_host_path id/name:to_path
[Options]:
    -L: 保持源目标中的链接</code></pre>
</li>
<li><p>diff：检查容器里文件结构的更改 ；</p>
<pre class=" language-shell"><code class="language-shell">docker diff id/name</code></pre>
</li>
</ul>
</blockquote>
<h2 id="网络管理命令"><a href="#网络管理命令" class="headerlink" title="网络管理命令"></a>网络管理命令</h2><h3 id="docker-network"><a href="#docker-network" class="headerlink" title="docker  network"></a>docker  network</h3><blockquote>
<ul>
<li><p>create：创建一个 docker 网络 ；</p>
<pre class=" language-shell"><code class="language-shell">docker network create [OPTIONS] net_name
[OPTIONS]:
    -d：指定 docker 网络类型，有 bridge、overlay 等类型</code></pre>
</li>
<li><p>ls：查看已有的 docker 网络 ；</p>
<pre class=" language-shell"><code class="language-shell">docker network ls
    -q：仅显示网络id
    -f：过滤条件

# 示例：根据网络类型过滤
$ docker network ls -f 'driver=bridge'</code></pre>
</li>
<li><p>connect：将容器连接到网络 ；</p>
<pre class=" language-shell"><code class="language-shell">docker network connect net_name container_id/name</code></pre>
</li>
<li><p>disconnect：断开容器与网络的连接 ；</p>
<pre class=" language-shell"><code class="language-shell">docker network disconnect [OPTIONS] net_name container_id/name
[OPTIONS]:
    -f：强制断开</code></pre>
</li>
<li><p>inspect：显示一个或多个网络上的详细信息 ；</p>
<pre class=" language-shell"><code class="language-shell">docker network inspect [Options] net_name
[Options]:
    -f：用给定的模版格式化输出信息</code></pre>
</li>
<li><p>rm：删除1个或多个网络 ；</p>
<pre class=" language-shell"><code class="language-shell">docker network rm net_name[net_2, ...]</code></pre>
</li>
<li><p>prune：删除所有未使用的网络 ；</p>
<pre class=" language-shell"><code class="language-shell">docker network prune [OPTIONS]
[OPTIONS]:
    -f：不提示确认</code></pre>
</li>
</ul>
</blockquote>
<h1 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h1><blockquote>
<p>  dockerfile 是一个用来构建镜像的文本文件，文本内容包含了一条条构建镜像所需的指令和说明。</p>
</blockquote>
<h2 id="构建命令"><a href="#构建命令" class="headerlink" title="构建命令"></a>构建命令</h2><blockquote>
<ul>
<li><p>build：dockerfile 利用 build 命令来构建一个镜像 ；</p>
<pre class=" language-shell"><code class="language-shell">docker build [Options] image_name:tag dockerfile_path
[Options]:
    -c：cpu核心数
    -m：最大内存
    -t：镜像标记

# 注意：存放 dockerfile 的文件夹中不要放无关的文件，因为 docker 会收集 dockerfile工作路径的所有文件用来构建镜像!</code></pre>
</li>
</ul>
</blockquote>
<h2 id="语法规则"><a href="#语法规则" class="headerlink" title="语法规则"></a>语法规则</h2><blockquote>
<p>  dockerfile 分为四个部分：基础镜像信息、维护者信息、镜像操作执行、容器启动时执行的指令 ；</p>
<ul>
<li><p>FROM：指定要引用的基础镜像，先从本地找，找不到再去 docker  hub 找 ；</p>
<p>  <strong>注意事项：</strong></p>
<ul>
<li><p>  基础镜像有 tag 一定要带上，否则不识别 ；</p>
</li>
<li><p>  任何 dockerfile 的第一条指令必须为 FROM ；</p>
</li>
<li><p>如果在同一个 dockerfile 中创建多个镜像，可以使用多个 FROM 指令；</p>
<pre class=" language-shell"><code class="language-shell">FROM centos:7.5.1804</code></pre>
</li>
</ul>
</li>
<li><p>RUN：在镜像 build 时执行命令 ；</p>
<p>  <strong>注意事项：</strong></p>
<ul>
<li><p>RUN 指令每执行一次都会在 docker 上新建一层镜像，造成镜像膨胀，所以无必要的话应该用 <code> &amp;&amp;</code> 连接多个指令；</p>
<pre class=" language-shell"><code class="language-shell"># 使用 RUN 指令有两种方式：

# 1. 默认使用 shell 执行命令，
RUN <command>
# 示例1：
RUN -c  # 等价于 /bin/sh -c

# 2. 推荐用法，采用 exec 的格式执行命令
RUN ["executable", "param1", "param2"] 
"executable"：可执行文件
"param1"，"param2"：执行时的参数

# 示例2：
RUN ["/bin/bash", "-c", "echo hello"]  # RUN /bin/bash -c echo hello
RUN ["./test.php", "dev", "offline"]  # RUN ./test.php dev offline

# 示例3：使用 && 连接多个命令
FROM centos
RUN yum install wget \
  && wget -O redis.tar.gz "http://download.redis.io/releases/redis-5.0.3.tar.gz" \
  && tar -xvf redis.tar.gz</code></pre>
</li>
</ul>
</li>
<li><p>CMD：类似于 RUN，为启动的容器指定默认要运行的程序，程序运行结束，容器也就结束 ；</p>
<p>  <strong>注意事项：</strong></p>
<ul>
<li><p>  类似于 RUN 指令，但二者运行的时间点不同，CMD 在 docker run 时运行。</p>
</li>
<li><p>每个  dockerfile 只能有 1 个 CMD 指令，如有多个只会执行最后一条，且如用户启动容器时指定了运行的命令，则会覆盖 CMD 的命令；</p>
<pre class=" language-shell"><code class="language-shell"># 有三种格式：
CMD <command>
CMD ["executable", "param1", "param2"]
# 该写法是为 ENTRYPOINT 指令指定的程序提供默认参数
CMD ["param1", "param2"] </code></pre>
</li>
</ul>
</li>
<li><p>ENTRYPOINT：类似于 CMD 指令，但不会被 docker run 的指定的参数覆盖，而且这些命令行参数会被当作参数送给 ENTRYPOINT 指令指定的程序 ；</p>
<p>  <strong>注意事项：</strong></p>
<ul>
<li><p>  CMD 指令指定参数将会成为 ENTRYPOINT 指定命令的参数 ；</p>
</li>
<li><p>  每个 dockerfile 只能有1个 ENTRYPOINT 指令，当有多个时只有最后一个生效 ；</p>
</li>
<li><p>会被 docker run 时指定的 –entrypoint 参数覆盖 ；</p>
<pre class=" language-shell"><code class="language-shell">FROM nginx
ENTRYPOINT ["nginx", "-c"] # 定参
CMD ["/etc/nginx/nginx.conf"] # 变参 

# 当不传参启动容器时
$ docker run nginx:test  
# 容器内执行
$ nginx -c /etc/nginx/nginx.conf  

# 当传参启动容器时
$ docker run nginx:test -c /etc/nginx/new.conf
# 容器内执行
$ nginx -c /etc/nginx/new.conf</code></pre>
</li>
</ul>
</li>
<li><p>ENV：指定环境变量，定义了环境变量，那么在后续的指令中，就可以使用这个环境变量，在此镜像启动的容器中也会存在。</p>
<p>  <strong>注意事项：</strong></p>
<ul>
<li><p>  可以有多个 ENV</p>
</li>
<li><p>该指令指定的环境变量会被启动容器时的 –env 参数覆盖</p>
<pre class=" language-shell"><code class="language-shell">ENV <key> <value>
ENV <key>=<value> <key2>=<value2> ...</code></pre>
</li>
</ul>
</li>
<li><p>ARG：构建参数，与 ENV 作用一至，不过作用域不一样，ARG 设置的环境变量仅在 docker build 的过程中有效 ；</p>
<pre class=" language-shell"><code class="language-shell">ARG <name> <value>
ARG <name>=<value></code></pre>
</li>
<li><p>WORKDIR：为后续的 RUN、CMD 和 ENTRYPOINT 指令配置工作目录，可以使用多个指令，后续的指令如果是相对路径，则会基于之前命令指定的路径；</p>
<pre class=" language-shell"><code class="language-shell">WORKDIR /path/to/workdir</code></pre>
</li>
<li><p>COPY：从宿主机复制数据到容器中 ；</p>
<pre class=" language-shell"><code class="language-shell">COPY <src> <dest>
src: 宿主机源路径
dest: 容器内目标路径，可以是绝对路径，也可以是工作目录(WORKDIR)的相对路径，如无路径会自动创建</code></pre>
</li>
<li><p>ADD：类似 COPY ，不过在源文件为 tar 压缩文件的话，压缩格式为 gzip, bzip2 , xz 的情况下，会自动复制并解压到目标路径 ；如无自动解压的需求，请优先使用 COPY ；</p>
<pre class=" language-shell"><code class="language-shell">ADD <src> <dest>
src: 宿主机源路径
dest: 容器内目标路径

# 如源文件是 gzip bzip2 xz 格式的压缩文件，ADD 会自动解压</code></pre>
<p>用法基本与 ADD相同，但是<code>&lt;src&gt;</code>只能是本地主机的路径</p>
</li>
<li><p>VOLUME：定义匿名数据卷，在启动容器时忘记挂载数据卷，会自动挂载到匿名卷，避免重要的数据，因容器重启而丢失 ；</p>
<pre class=" language-shell"><code class="language-shell">VOLUME ["<路径1>", "<路径2>", ...]
VOLUME <路径>

# 在启动容器 docker run 的时候，我们可以通过 -v 参数修改挂载点</code></pre>
</li>
<li><p>EXPOSE：仅仅只是声明容器内服务所监听的端口 ；</p>
<pre class=" language-shell"><code class="language-shell">EXPOSE <port1> <port2></code></pre>
</li>
<li><p>USER：用于指定后续执行命令的用户和用户组，这边只是切换后续命令执行的用户（用户和用户组必须提前已经存在）；</p>
<pre class=" language-shell"><code class="language-shell">USER <用户名>[:<用户组>]

# 当服务不需要管理员权限时，可以通过该命令指定运行用户
RUN groupadd -r postgres && useradd -r -g postgres postgres</code></pre>
</li>
<li><p>ONBUILD：配置当所创建的镜像作为其他镜像的基础镜像时，所执行的创建操作指令 ，可以有多个 ONBUILD 指令 ；</p>
<pre class=" language-shell"><code class="language-shell">ONBUILD [instruction]
# 示例：
ONBUILD ADD . /app/src</code></pre>
</li>
<li><p>STOPSIGNAL：指定镜像构建的容器接收的退出信号的值 ；</p>
<pre class=" language-shell"><code class="language-shell">STOPSIGNAL signal</code></pre>
</li>
<li><p>HEALTHCHECK：用于指定某个程序或者指令来监控 docker 容器服务的运行状态 ；</p>
<pre class=" language-shell"><code class="language-shell">HEALTHCHECK [Options] CMD command：设置检查容器健康状况的命令，根据所执行命令返回值来判断 ;
[Options]:
     --interval=DURARION (默认：30s)：多久检查一次
     --timeout=DURARION (默认：30s)：每次检查等待结果的超时时间
     --retries=N (默认：3)：如果失败了，重试几次才最终确定失败

# 禁止基础镜像中的健康检查
HEALTHCHECK NONE</code></pre>
</li>
<li><p>SHELL：指定其他命令使用 shell 时默认的 shell 类型，默认值为：[“/bin/sh”, “-c”] ；</p>
<pre class=" language-shell"><code class="language-shell">SHELL ["executable", "parameters"]</code></pre>
</li>
<li><p>  MAINTAINER：指定维护者信息 ；</p>
</li>
<li><p>LABEL：用来生成镜像的元数据标签信息，可以有多个 LABEL ；</p>
<pre class=" language-shell"><code class="language-shell">LABEL <key> <value>
LABEL <key>=<value>
# 示例：
LABEL version="1.0"</code></pre>
</li>
</ul>
</blockquote>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><pre class=" language-dockerfile"><code class="language-dockerfile">FROM python:3.8-buster

MAINTAINER Chen

ENV LC_ALL C.UTF-8
ENV LANG C.UTF-8
ENV TZ Asia/Shanghai

WORKDIR  /app

COPY ./the_first/ /app/the_first/

RUN pip install gunicorn && \
    pip install -i https://pypi.tuna.tsinghua.edu.cn/simple/ -r /app/the_first/requirements.txt

CMD cd ./the_first && \
    python3 manage.py collectstatic --noinput && \
    gunicorn --workers 2  --log-level debug --bind '0.0.0.0:8000'  'the_first.wsgi'</code></pre>
<h1 id="Docker-compose"><a href="#Docker-compose" class="headerlink" title="Docker-compose"></a>Docker-compose</h1><h2 id="语法规则-1"><a href="#语法规则-1" class="headerlink" title="语法规则"></a>语法规则</h2><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3'</span>

<span class="token comment" spellcheck="true"># 创建容器数据卷</span>
<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token comment" spellcheck="true"># 数据卷名</span>
  <span class="token key atrule">static</span><span class="token punctuation">:</span>

<span class="token comment" spellcheck="true"># 创建网络</span>
<span class="token key atrule">networks</span><span class="token punctuation">:</span>
  <span class="token comment" spellcheck="true"># 网络名称</span>
  <span class="token key atrule">django_network</span><span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># 网络模式</span>
    <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge

<span class="token comment" spellcheck="true"># 创建加密文件</span>
<span class="token key atrule">secrets</span><span class="token punctuation">:</span>
  <span class="token key atrule">my_secret</span><span class="token punctuation">:</span>
    <span class="token key atrule">file</span><span class="token punctuation">:</span> ./my_secret.txt

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token comment" spellcheck="true"># 定义一个服务名</span>
  <span class="token key atrule">the_first_django</span><span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># 指定构建容器的 Dockerfile 所在的路径</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span>
      <span class="token comment" spellcheck="true"># 指定上下文环境，是基于 compose.yml 的相对路径</span>
      <span class="token key atrule">context</span><span class="token punctuation">:</span> ./
      <span class="token comment" spellcheck="true"># 指定 Dockerfile的路径，是 基于 context 的相对路径</span>
      <span class="token key atrule">dockerfile</span><span class="token punctuation">:</span> compose/production/django/Dockerfile
      <span class="token comment" spellcheck="true"># 指定构建过程中的环境变量，构建后删除</span>
      <span class="token key atrule">args</span><span class="token punctuation">:</span>
        <span class="token key atrule">buildno</span><span class="token punctuation">:</span> <span class="token number">1</span>
        <span class="token key atrule">password</span><span class="token punctuation">:</span> secret

    <span class="token comment" spellcheck="true"># 指定容器运行的镜像，不使用 build</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> django<span class="token punctuation">:</span>latest

    <span class="token comment" spellcheck="true"># 指定容器名称</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> the_first

    <span class="token comment" spellcheck="true"># 网络模式：bridge｜host｜none</span>
    <span class="token comment" spellcheck="true"># network_mode: "service:[service name]"</span>
    <span class="token comment" spellcheck="true"># network_mode: "container:[container name/id]"</span>
    <span class="token key atrule">network_mode</span><span class="token punctuation">:</span> <span class="token string">"bridge"</span>

    <span class="token comment" spellcheck="true"># 加入指定的网络</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> django_network

    <span class="token comment" spellcheck="true"># 映射端口(宿主机:容器)</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"8000:8000"</span>

    <span class="token comment" spellcheck="true"># 暴露端口，但不映射到宿主机，只被连接的服务访问</span>
    <span class="token key atrule">expose</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">'8080'</span>

      <span class="token comment" spellcheck="true"># 设置容器自动重启策略</span>
      <span class="token comment" spellcheck="true"># no：默认，在任何情况下都不会重启容器。</span>
      <span class="token comment" spellcheck="true"># always：总是重新启动</span>
      <span class="token comment" spellcheck="true"># on-failure：在容器非正常退出时（退出状态非0），才会重启容器。</span>
      <span class="token comment" spellcheck="true"># unless-stopped：总是重启容器，但是不考虑在Docker守护进程启动时就已经停止了的容器</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> on<span class="token punctuation">-</span>failure<span class="token punctuation">:</span><span class="token number">3</span>

    <span class="token comment" spellcheck="true"># 是否拥有宿主机 root 权限</span>
    <span class="token key atrule">privileged</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>

    <span class="token comment" spellcheck="true"># 添加环境变量</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">RACK_ENV</span><span class="token punctuation">:</span> development
      <span class="token comment" spellcheck="true"># 布尔值需要用引号引起来，以确保 YML 解析器不会将其转换为 True 或 False</span>
      <span class="token punctuation">-</span> <span class="token key atrule">SHOW</span><span class="token punctuation">:</span> <span class="token string">'true'</span>

    <span class="token comment" spellcheck="true"># 从文件添加环境变量</span>
    <span class="token key atrule">env_file</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./common.env

    <span class="token comment" spellcheck="true"># 挂载一个目录或者已经存在的数据卷容器</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> static<span class="token punctuation">:</span>/app/the_first/static/  <span class="token comment" spellcheck="true"># 将该容器的静态文件共享到其他的容器中</span>
      <span class="token punctuation">-</span> /opt/data<span class="token punctuation">:</span>/var/lib/mysql  <span class="token comment" spellcheck="true"># 使用绝对路径挂载数据卷</span>
      <span class="token comment" spellcheck="true"># :ro 表示为只读</span>
      <span class="token punctuation">-</span> ./configs<span class="token punctuation">:</span>/etc/configs/<span class="token punctuation">:</span>ro  <span class="token comment" spellcheck="true"># 使用以 Compose 配置文件为基本路径的相对路径</span>

    <span class="token comment" spellcheck="true"># 容器启动后执行的命令</span>
    <span class="token comment" spellcheck="true"># command: /start.sh</span>

    <span class="token comment" spellcheck="true"># ENTRYPOINT，覆盖 RUN 命令 和 Dockerfile 中的同名指令</span>
    <span class="token comment" spellcheck="true"># entrypoint: /code/entrypoint.sh</span>

    <span class="token comment" spellcheck="true"># 容器依赖</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> mysql<span class="token punctuation">-</span>django  <span class="token comment" spellcheck="true"># 另外的服务名</span>
      <span class="token punctuation">-</span> redis<span class="token punctuation">-</span>django

    <span class="token comment" spellcheck="true"># 指定设备映射列表</span>
    <span class="token key atrule">devices</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"/dev/ttyUSB0:/dev/ttyUSB0"</span>

    <span class="token comment" spellcheck="true"># 自定义 DNS 服务器</span>
    <span class="token key atrule">dns</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 8.8.8.8
      <span class="token punctuation">-</span> 9.9.9.9

    <span class="token comment" spellcheck="true"># 自定义 DNS 搜索域</span>
    <span class="token key atrule">dns_search</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> dc1.example.com
      <span class="token punctuation">-</span> dc2.example.com

    <span class="token comment" spellcheck="true"># 添加主机名映射，类似 docker client --add-host</span>
    <span class="token comment" spellcheck="true"># 会在此服务的内部容器的 /etc/hosts 中创建 IP 和主机名的映射关系</span>
    <span class="token key atrule">extra_hosts</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"somehost:162.242.195.82"</span>
      <span class="token punctuation">-</span> <span class="token string">"otherhost:50.31.209.229"</span>

    <span class="token comment" spellcheck="true"># 存储敏感数据，例如密码</span>
    <span class="token key atrule">secrets</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> my_secret

    <span class="token comment" spellcheck="true"># 在容器内安装一个临时文件系统</span>
    <span class="token key atrule">tmpfs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /tmp

    <span class="token comment" spellcheck="true"># 用于检测 docker 服务是否健康运行</span>
    <span class="token key atrule">healthcheck</span><span class="token punctuation">:</span>
      <span class="token key atrule">test</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">"CMD"</span><span class="token punctuation">,</span> <span class="token string">"curl"</span><span class="token punctuation">,</span> <span class="token string">"-f"</span><span class="token punctuation">,</span> <span class="token string">"http://localhost"</span> <span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 设置检测程序</span>
      <span class="token key atrule">interval</span><span class="token punctuation">:</span> 1m30s <span class="token comment" spellcheck="true"># 设置检测间隔</span>
      <span class="token key atrule">timeout</span><span class="token punctuation">:</span> 10s <span class="token comment" spellcheck="true"># 设置检测超时时间</span>
      <span class="token key atrule">retries</span><span class="token punctuation">:</span> <span class="token number">3 </span><span class="token comment" spellcheck="true"># 设置重试次数</span>
      <span class="token key atrule">start_period</span><span class="token punctuation">:</span> 40s <span class="token comment" spellcheck="true"># 启动后，多少秒开始启动检测程序</span>

    <span class="token comment" spellcheck="true"># 链接到其它服务器中的容器</span>
    <span class="token key atrule">links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> db
      <span class="token punctuation">-</span> db<span class="token punctuation">:</span>mysql
      <span class="token punctuation">-</span> redis

    <span class="token comment" spellcheck="true"># 让 compose 项目里面的容器链接到项目配置外部的容器（外部容器中必须至少有一个容器链接到项目内服务的同一个网络里）</span>
    <span class="token key atrule">external_links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> redis_1
      <span class="token punctuation">-</span> project_db_1<span class="token punctuation">:</span>mysql
      <span class="token punctuation">-</span> project_db_1<span class="token punctuation">:</span>postgresql

    <span class="token comment" spellcheck="true"># 服务的日志记录配置</span>
    <span class="token key atrule">logging</span><span class="token punctuation">:</span>
      <span class="token comment" spellcheck="true"># 指定服务容器的日志记录驱动程序: json-file/syslog/none</span>
      <span class="token key atrule">driver</span><span class="token punctuation">:</span> json<span class="token punctuation">-</span>file
      <span class="token key atrule">options</span><span class="token punctuation">:</span>
        <span class="token comment" spellcheck="true"># 当 driver: syslog 时</span>
        <span class="token comment" spellcheck="true"># syslog-address: "tcp://ip"  # 指定日志接收地址</span>

        <span class="token comment" spellcheck="true"># 当 driver: json-file 时</span>
        <span class="token key atrule">max-size</span><span class="token punctuation">:</span> <span class="token string">"200k"</span>  <span class="token comment" spellcheck="true"># 单个文件大小为 200 k</span>
        <span class="token key atrule">max-file</span><span class="token punctuation">:</span> <span class="token string">"10"</span>  <span class="token comment" spellcheck="true"># 最多10个文件</span>

  <span class="token comment" spellcheck="true"># 被依赖的服务</span>
  <span class="token key atrule">redis-django</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis

  <span class="token key atrule">mysql-django</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql</code></pre>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><pre class=" language-shell"><code class="language-shell"># -f  指定使用的 Compose 模板文件，默认为 docker-compose.yml，可以多次指定。
docker-compose -f docker-compose.yml up -d

# 启动所有容器，-d 将会在后台启动并运行所有的容器
docker-compose up -d

# 停用移除所有容器以及网络相关
docker-compose down

# 查看服务容器的输出
docker-compose logs

# 列出项目中目前的所有容器
docker-compose ps

# 构建（重新构建）项目中的服务容器。服务容器一旦构建后，将会带上一个标记名，例如对于 web 项目中的一个 db 容器，可能是 web_db。可以随时在项目目录下运行 docker-compose build 来重新构建服务
docker-compose build

# 拉取服务依赖的镜像
docker-compose pull

# 重启项目中的服务
docker-compose restart

# 删除所有（停止状态的）服务容器。推荐先执行 docker-compose stop 命令来停止容器。
docker-compose rm

# 在指定服务上执行一个命令。
docker-compose run ubuntu ping docker.com

# 设置指定服务运行的容器个数。通过 service=num 的参数来设置数量
docker-compose scale web=3 db=2

# 启动已经存在的服务容器。
docker-compose start

# 停止已经处于运行状态的容器，但不删除它。通过 docker-compose start 可以再次启动这些容器。
docker-compose stop</code></pre>
<h2 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h2><pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3'</span>

<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token key atrule">static</span><span class="token punctuation">:</span>
  <span class="token key atrule">media</span><span class="token punctuation">:</span>

<span class="token key atrule">networks</span><span class="token punctuation">:</span>
  <span class="token key atrule">django_network</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge

<span class="token key atrule">services</span><span class="token punctuation">:</span>

  <span class="token comment" spellcheck="true"># mysql 服务</span>
  <span class="token key atrule">mysql-django</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span>latest
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>django
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> django_network
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 13306<span class="token punctuation">:</span><span class="token number">3306</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">privileged</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">TZ</span><span class="token punctuation">:</span> Asia/Shanghai
      <span class="token key atrule">MYSQL_ROOT_PASSWORD</span><span class="token punctuation">:</span> mysql13306123456
      <span class="token key atrule">MYSQL_DATABASE</span><span class="token punctuation">:</span> the_first
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /usr/local/workspace/mysql/data/<span class="token punctuation">:</span>/var/lib/mysql/
    <span class="token key atrule">command</span><span class="token punctuation">:</span>
      <span class="token comment" spellcheck="true"># MySQL8.0 之后，默认的加密规则使用的是 caching_sha2_password</span>
      <span class="token comment" spellcheck="true"># 客户端工具不支持，所以不要修改其加密规则</span>
      <span class="token punctuation">-</span><span class="token punctuation">-</span>default<span class="token punctuation">-</span>authentication<span class="token punctuation">-</span>plugin=mysql_native_password
      <span class="token punctuation">-</span><span class="token punctuation">-</span>character<span class="token punctuation">-</span>set<span class="token punctuation">-</span>server=utf8mb4
      <span class="token punctuation">-</span><span class="token punctuation">-</span>collation<span class="token punctuation">-</span>server=utf8mb4_unicode_ci

  <span class="token comment" spellcheck="true"># redis 服务</span>
  <span class="token key atrule">redis-django</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>latest
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span>django
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> django_network
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 16379<span class="token punctuation">:</span><span class="token number">6379</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">privileged</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">TZ</span><span class="token punctuation">:</span> Asia/Shanghai
    <span class="token comment" spellcheck="true"># 容器启动后，启动根据配置文件启动 redis-server</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span>server /etc/redis/redis.conf <span class="token punctuation">-</span><span class="token punctuation">-</span>appendonly yes <span class="token punctuation">-</span><span class="token punctuation">-</span>requirepass 'redis16379123456'
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /usr/local/workspace/redis/data<span class="token punctuation">:</span>/data/
      <span class="token punctuation">-</span> /usr/local/workspace/redis/redis.conf<span class="token punctuation">:</span>/etc/redis/redis.conf/

  <span class="token comment" spellcheck="true"># django 服务</span>
  <span class="token key atrule">the_first</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> the_first<span class="token punctuation">:</span>latest
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> the_first
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> django_network
    <span class="token key atrule">expose</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">'8000'</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">privileged</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">TZ</span><span class="token punctuation">:</span> Asia/Shanghai
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> static<span class="token punctuation">:</span>/app/the_first/static/  <span class="token comment" spellcheck="true"># 将该容器的静态文件共享到其他的容器中</span>
      <span class="token punctuation">-</span> media<span class="token punctuation">:</span>/app/the_first/media/
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> mysql<span class="token punctuation">-</span>django
      <span class="token punctuation">-</span> redis<span class="token punctuation">-</span>django

  <span class="token comment" spellcheck="true"># nginx 服务</span>
  <span class="token key atrule">nginx-django</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>latest
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>django
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> django_network
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token datetime number">80:80</span>
      <span class="token punctuation">-</span> 443<span class="token punctuation">:</span><span class="token number">443</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">privileged</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">TZ</span><span class="token punctuation">:</span> Asia/Shanghai
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token comment" spellcheck="true"># 与 django 服务共享 static media 目录</span>
      <span class="token punctuation">-</span> static<span class="token punctuation">:</span>/app/the_first/static/
      <span class="token punctuation">-</span> media<span class="token punctuation">:</span>/app/the_first/media/
      <span class="token punctuation">-</span> /usr/local/workspace/nginx/conf/nginx.conf<span class="token punctuation">:</span>/etc/nginx/nginx.conf
      <span class="token punctuation">-</span> /usr/local/workspace/nginx/conf.d<span class="token punctuation">:</span>/etc/nginx/conf.d
      <span class="token punctuation">-</span> /usr/local/workspace/nginx/html<span class="token punctuation">:</span>/usr/share/nginx/html
      <span class="token punctuation">-</span> /usr/local/workspace/nginx/log<span class="token punctuation">:</span>/var/log/nginx
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> the_first</code></pre>
<h1 id="Docker-命令快捷栏"><a href="#Docker-命令快捷栏" class="headerlink" title="Docker 命令快捷栏"></a>Docker 命令快捷栏</h1><blockquote>
<ul>
<li><p>设置 docker 开机自动启动(服务器重启后自动重启)</p>
<pre class=" language-shell"><code class="language-shell">$ systemctl enable docker</code></pre>
</li>
<li><p>进去容器内部</p>
<pre class=" language-shell"><code class="language-shell">$ docker exec -it 容器id/name /bin/bash</code></pre>
</li>
<li><p>启动一个 redis 容器</p>
<pre class=" language-shell"><code class="language-shell">$ docker run -itd -p 16379:6379 --name='redis-django' --network='bridge' --restart='always' \
-v /usr/local/workspace/redis/data:/data \
-v /usr/local/workspace/redis/redis.conf:/etc/redis/redis.conf \
redis redis-server /etc/redis/redis.conf --appendonly yes --requirepass 'redis16379123456'

# 参数解释：
# 挂载数据卷和配置文件
-v /usr/local/workspace/redis/data:/data
-v /usr/local/workspace/redis/redis.conf:/etc/redis/redis.conf
# 使用配置文件启动
/etc/redis/redis.conf
--appendonly yes: 开启持久化
--requirepass 'redis16379123456': 设置密码</code></pre>
</li>
<li><p>启动一个 mysql 容器</p>
<pre class=" language-shell"><code class="language-shell">$ docker run -itd -p 13306:3306 --name='mysql-django' --network='bridge' --restart='always' -e MYSQL_ROOT_PASSWORD=mysql13306123456 \
-v /usr/local/workspace/mysql/data:/var/lib/mysql \
mysql:latest

# 参数解释：
# 挂载数据卷和配置文件
-v /usr/local/workspace/mysql/data:/var/lib/mysql
-v /usr/local/workspace/mysql/etc:/etc/mysql
-e: 为容器设置环境变量，为 mysql 初始密码</code></pre>
</li>
<li><p>启动一个 rabbitmq 容器</p>
<pre class=" language-shell"><code class="language-shell">$ docker run -itd  -p 5672:5672 --name='rabbitmq-django' --network='bridge' --restart='always' rabbitmq:latest

# 端口参数解释：
5672、5671: AMQP 0-9-1 without and with TLSclient 端通信口
15671: 管理监听端口
15672: 管理界面ui使用的端口
25672: (Erlang distribution）server 间内部通信口
4369: （epmd)epmd代表 Erlang 端口映射守护进程，erlang 发现口</code></pre>
</li>
<li><p>启动一个 nginx 容器</p>
<p>  ```shell<br>  $ docker run -itd -p 80:80 –name=’nginx-django’ –network=’bridge’ –restart=’always’ <br>  -v /usr/local/workspace/nginx/conf/nginx.conf:/etc/nginx/nginx.conf \</p>
</li>
<li><p>v /usr/local/workspace/nginx/conf.d:/etc/nginx/conf.d <br>   -v /usr/local/workspace/nginx/html:/usr/share/nginx/html <br>   -v /usr/local/workspace/nginx/log:/var/log/nginx <br>   nginx</p>
<h1 id="参数解释："><a href="#参数解释：" class="headerlink" title="参数解释："></a>参数解释：</h1><h1 id="将宿主机-workspace-nginx-下的配置文件、日志、html-文件挂载到-Nginx-容器中"><a href="#将宿主机-workspace-nginx-下的配置文件、日志、html-文件挂载到-Nginx-容器中" class="headerlink" title="将宿主机 workspace/nginx/ 下的配置文件、日志、html 文件挂载到 Nginx 容器中"></a>将宿主机 workspace/nginx/ 下的配置文件、日志、html 文件挂载到 Nginx 容器中</h1><p>   -v /usr/local/workspace/nginx/conf/nginx.conf:/etc/nginx/nginx.conf<br>   -v /usr/local/workspace/nginx/conf.d:/etc/nginx/conf.d<br>   -v /usr/local/workspace/nginx/html:/usr/share/nginx/html<br>   -v /usr/local/workspace/nginx/log:/var/log/nginx</p>
<pre><code></code></pre>
</li>
<li><p>启动一个 Django 项目</p>
<pre class=" language-shell"><code class="language-shell">$ docker run -itd -p 8000:8000 --name='django' --network='bridge' --restart='always' django</code></pre>
</li>
</ul>
</blockquote>

            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">天听</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://godhearing.cn/2021/03/09/docker-xiang-jie-ju-xiang/">http://godhearing.cn/2021/03/09/docker-xiang-jie-ju-xiang/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint polocy. If reproduced, please indicate source
                    <a href="/about" target="_blank">天听</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Docker/">
                                    <span class="chip bg-color">Docker</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '',
        clientSecret: '',
        repo: '',
        owner: '',
        admin: null,
        id: '2021-03-09T00-00-00',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2021/03/12/casbin/">
                    <div class="card-image">
                        
                        <img src="/medias/featureimages/79.png" class="responsive-img" alt="Casbin">
                        
                        <span class="card-title">Casbin</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-03-12
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Casbin/" class="post-category">
                                    Casbin
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Casbin/">
                        <span class="chip bg-color">Casbin</span>
                    </a>
                    
                    <a href="/tags/FastAPI/">
                        <span class="chip bg-color">FastAPI</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/03/05/nginx-kua-yu-pei-zhi/">
                    <div class="card-image">
                        
                        <img src="/medias/featureimages/77.jpg" class="responsive-img" alt="nginx跨域配置">
                        
                        <span class="card-title">nginx跨域配置</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-03-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Nginx/" class="post-category">
                                    Nginx
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Nginx/">
                        <span class="chip bg-color">Nginx</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.5'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2019</span>
            <a href="/about" target="_blank">天 听</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">116.2k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/God-hearing2020" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:2274201339@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2274201339" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2274201339" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    
    <script type="text/javascript" color="255,128,128"
        pointColor="255,128,128" opacity='1'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    
    
    <script type="text/javascript" size="150" alpha='0.6'
        zIndex="-1" src="/libs/background/ribbon-refresh.min.js" async="async"></script>
    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":250,"height":500},"mobile":{"show":true},"rect":"opacity:0.7","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>
